import{r as m,j as e,C as L,R as u,a as c,c as h,B as R,b as q,d as M}from"./index-Oz_OtaLj.js";import{A as S}from"./Alert-n9N3cVv9.js";import{F as a}from"./Form-BZsI-z2A.js";const B="/PerimetrosMaitenrehue/assets/cerco_stock-IIkJ71F9.webp",f={"1.50m":["2 Placas de 50cm de alto","1 Placa de 30cm de alto","1 Barda (10cm de altura efectiva)"],"1.90m":["3 Placas de 50cm de alto","1 Placa de 30cm de alto","1 Barda (10cm de altura efectiva)"],"2.10m":["4 Placas de 50cm de alto","1 Barda (10cm de altura efectiva)"],"2.40m":["4 Placas de 50cm de alto","1 Placa de 30cm de alto","1 Barda (10 cm de altura efectiva"],Otra:["Componentes para altura personalizada: Por favor, consulta con un asesor."]},V=()=>{const[n,y]=m.useState({name:"",rut:"",phone:"",address:"",email:"",fenceHeight:"1.90m",fenceType:"Cerco Vibrado Estándar",linearMeters:"",message:""}),[H,p]=m.useState(!1),[N,x]=m.useState(null),[P,E]=m.useState(null),[j,g]=m.useState(null),[I,C]=m.useState(f[n.fenceHeight]);m.useEffect(()=>{f[n.fenceHeight]&&C(f[n.fenceHeight])},[n.fenceHeight]);const k=s=>{if(!/^[0-9]+[kK0-9]$/.test(s))return!1;const r=s.slice(0,-1);let t=s.slice(-1).toUpperCase(),i=0,o=2;for(let b=r.length-1;b>=0;b--)i+=parseInt(r[b],10)*o,o++,o>7&&(o=2);let d=11-i%11;return d===11?d="0":d===10?d="K":d=String(d),d===t},T=s=>{let r=s.replace(/[^0-9kK]/g,"");r.length>9&&(r=r.slice(0,9)),r=r.toUpperCase();let t="";for(r.length>1&&(t=r.slice(-1),r=r.slice(0,-1));r.length>3;)t="."+r.slice(-3)+t,r=r.slice(0,-3);return r.length>0&&(t=r+t),t.length>0&&!t.includes("-")&&(t=t.slice(0,-1)+"-"+t.slice(-1)),t},l=s=>{const{name:r,value:t}=s.target;let i=t;if(r==="rut"){const o=t.replace(/[^0-9kK]/g,"");i=T(t),o.length>=7?k(o)?g(null):g("El RUT ingresado no es válido."):g(null)}y(o=>{const v={...o,[r]:i};return r==="fenceHeight"&&(v.fenceType=t==="Otra"?"Cerco Vibrado Personalizado":`Cerco Vibrado ${t}`,f[t]?C(f[t]):C([])),v})},F=s=>{switch(s){case"1.90m":return M;default:return B}},w=async s=>{const r=s.currentTarget;if(s.preventDefault(),s.stopPropagation(),j){p(!0),x("Por favor, corrige el RUT antes de enviar.");return}if(r.checkValidity()===!1){p(!0),x("Por favor, completa todos los campos obligatorios.");return}E(null),x(null),p(!1);try{const t=await fetch(q.quotes,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await t.json();if(!t.ok)throw new Error(i.message||"Error al enviar la cotización");E("¡Cotización enviada exitosamente! Nos pondremos en contacto contigo pronto."),y({name:"",rut:"",phone:"",address:"",email:"",fenceHeight:"1.50m",fenceType:"Cerco Vibrado Estándar",linearMeters:"",message:""}),p(!1)}catch(t){x(t.message)}};return e.jsx("section",{className:"quote-page-section",children:e.jsxs(L,{children:[e.jsx(u,{className:"justify-content-center",children:e.jsx(c,{md:8,children:e.jsx(h,{className:"quote-card",children:e.jsxs(h.Body,{children:[e.jsx("h2",{className:"text-center mb-4",children:"Solicita tu Cotización"}),e.jsx("p",{className:"text-center text-muted mb-4",children:"Completa el formulario y te enviaremos una cotización detallada a la brevedad."}),P&&e.jsx(S,{variant:"success",children:P}),N&&e.jsx(S,{variant:"danger",children:N}),e.jsxs(a,{noValidate:!0,validated:H,onSubmit:w,children:[e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formName",children:[e.jsx(a.Label,{children:"Nombre Completo"}),e.jsx(a.Control,{type:"text",name:"name",value:n.name,onChange:l,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:"Por favor, ingresa tu nombre completo."})]})}),e.jsx(c,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formRut",children:[e.jsx(a.Label,{children:"RUT"}),e.jsx(a.Control,{type:"text",name:"rut",value:n.rut,onChange:l,required:!0,isInvalid:!!j}),e.jsx(a.Control.Feedback,{type:"invalid",children:j||"Por favor, ingresa un RUT válido (ej. 12.345.678-9)."})]})})]}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formPhone",children:[e.jsx(a.Label,{children:"Número de Teléfono"}),e.jsx(a.Control,{type:"tel",name:"phone",value:n.phone,onChange:l,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:"Por favor, ingresa tu número de teléfono."})]})}),e.jsx(c,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formEmail",children:[e.jsx(a.Label,{children:"Correo Electrónico"}),e.jsx(a.Control,{type:"email",name:"email",value:n.email,onChange:l,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:"Por favor, ingresa un correo electrónico válido."})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formAddress",children:[e.jsx(a.Label,{children:"Dirección / Comuna"}),e.jsx(a.Control,{type:"text",name:"address",value:n.address,onChange:l,required:!0}),e.jsx(a.Control.Feedback,{type:"invalid",children:"Por favor, ingresa tu dirección o comuna."})]}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formFenceHeight",children:[e.jsx(a.Label,{children:"Altura del Cerco"}),e.jsxs(a.Select,{name:"fenceHeight",value:n.fenceHeight,onChange:l,required:!0,children:[e.jsx("option",{value:"",children:"Selecciona una altura"}),e.jsx("option",{children:"1.50m"}),e.jsx("option",{children:"1.90m"}),e.jsx("option",{children:"2.10m"}),e.jsx("option",{children:"2.40m"}),e.jsx("option",{children:"Otra"})]}),e.jsx(a.Control.Feedback,{type:"invalid",children:"Por favor, selecciona la altura del cerco."})]})}),e.jsx(c,{md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formLinearMeters",children:[e.jsx(a.Label,{children:"Metros Lineales (aprox.)"}),e.jsx(a.Control,{type:"number",name:"linearMeters",value:n.linearMeters,onChange:l,required:!0,min:"1"}),e.jsx(a.Control.Feedback,{type:"invalid",children:"Por favor, ingresa los metros lineales."})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formMessage",children:[e.jsx(a.Label,{children:"Mensaje Adicional"}),e.jsx(a.Control,{as:"textarea",name:"message",rows:4,value:n.message,onChange:l,placeholder:"Indícanos cualquier detalle importante para tu proyecto."})]}),n.fenceHeight&&I.length>0&&e.jsx(h,{className:"mb-3 components-card",children:e.jsxs(h.Body,{children:[e.jsxs(h.Title,{children:["Componentes para ",n.fenceHeight]}),e.jsx("ul",{children:I.map((s,r)=>e.jsx("li",{children:s},r))})]})}),e.jsx("div",{className:"d-grid",children:e.jsx(R,{variant:"primary",type:"submit",size:"lg",children:"Enviar Cotización"})})]})]})})})}),e.jsx(u,{className:"justify-content-center mt-5",children:e.jsx(c,{md:8,children:e.jsx("img",{src:F(n.fenceHeight),alt:"Cerco de referencia",className:"img-fluid rounded shadow-lg"})})})]})})};export{V as default};
