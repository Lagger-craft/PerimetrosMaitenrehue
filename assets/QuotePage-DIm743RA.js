import{r as m,j as e,C as L,R as u,a as i,c as h,B as R,b as q,d as M}from"./index-CY5RqpeY.js";import{A as S}from"./Alert-BTLZx-9d.js";import{F as r}from"./Form-Ym7nrSmI.js";const G="/PerimetrosMaitenrehue/assets/cerco_stock-IIkJ71F9.webp",p={"1.50m":["2 Placas de 50cm de alto","1 Placa de 30cm de alto","1 Barda (10cm de altura efectiva)"],"1.90m":["3 Placas de 50cm de alto","1 Placa de 30cm de alto","1 Barda (10cm de altura efectiva)"],"2.20m":["🚧 Proximamente"],Otra:["Componentes para altura personalizada: Por favor, consulta con un asesor."]},B=()=>{const[t,y]=m.useState({name:"",rut:"",phone:"",address:"",email:"",fenceHeight:"1.90m",fenceType:"Cerco Vibrado Estándar",linearMeters:"",message:""}),[H,x]=m.useState(!1),[N,f]=m.useState(null),[P,E]=m.useState(null),[j,g]=m.useState(null),[I,C]=m.useState(p[t.fenceHeight]);m.useEffect(()=>{p[t.fenceHeight]&&C(p[t.fenceHeight])},[t.fenceHeight]);const k=s=>{if(!/^[0-9]+[kK0-9]$/.test(s))return!1;const a=s.slice(0,-1);let n=s.slice(-1).toUpperCase(),c=0,o=2;for(let b=a.length-1;b>=0;b--)c+=parseInt(a[b],10)*o,o++,o>7&&(o=2);let d=11-c%11;return d===11?d="0":d===10?d="K":d=String(d),d===n},T=s=>{let a=s.replace(/[^0-9kK]/g,"");a.length>9&&(a=a.slice(0,9)),a=a.toUpperCase();let n="";for(a.length>1&&(n=a.slice(-1),a=a.slice(0,-1));a.length>3;)n="."+a.slice(-3)+n,a=a.slice(0,-3);return a.length>0&&(n=a+n),n.length>0&&!n.includes("-")&&(n=n.slice(0,-1)+"-"+n.slice(-1)),n},l=s=>{const{name:a,value:n}=s.target;let c=n;if(a==="rut"){const o=n.replace(/[^0-9kK]/g,"");c=T(n),o.length>=7?k(o)?g(null):g("El RUT ingresado no es válido."):g(null)}y(o=>{const v={...o,[a]:c};return a==="fenceHeight"&&(v.fenceType=n==="Otra"?"Cerco Vibrado Personalizado":`Cerco Vibrado ${n}`,p[n]?C(p[n]):C([])),v})},F=s=>{switch(s){case"1.90m":return M;default:return G}},w=async s=>{const a=s.currentTarget;if(s.preventDefault(),s.stopPropagation(),j){x(!0),f("Por favor, corrige el RUT antes de enviar.");return}if(a.checkValidity()===!1){x(!0),f("Por favor, completa todos los campos obligatorios.");return}E(null),f(null),x(!1);try{const n=await fetch(q.quotes,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),c=await n.json();if(!n.ok)throw new Error(c.message||"Error al enviar la cotización");E("¡Cotización enviada exitosamente! Nos pondremos en contacto contigo pronto."),y({name:"",rut:"",phone:"",address:"",email:"",fenceHeight:"1.50m",fenceType:"Cerco Vibrado Estándar",linearMeters:"",message:""}),x(!1)}catch(n){f(n.message)}};return e.jsx("section",{className:"quote-page-section",children:e.jsxs(L,{children:[e.jsx(u,{className:"justify-content-center",children:e.jsx(i,{md:8,children:e.jsx(h,{className:"quote-card",children:e.jsxs(h.Body,{children:[e.jsx("h2",{className:"text-center mb-4",children:"Solicita tu Cotización"}),e.jsx("p",{className:"text-center text-muted mb-4",children:"Completa el formulario y te enviaremos una cotización detallada a la brevedad."}),P&&e.jsx(S,{variant:"success",children:P}),N&&e.jsx(S,{variant:"danger",children:N}),e.jsxs(r,{noValidate:!0,validated:H,onSubmit:w,children:[e.jsxs(u,{children:[e.jsx(i,{md:6,children:e.jsxs(r.Group,{className:"mb-3",controlId:"formName",children:[e.jsx(r.Label,{children:"Nombre Completo"}),e.jsx(r.Control,{type:"text",name:"name",value:t.name,onChange:l,required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Por favor, ingresa tu nombre completo."})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{className:"mb-3",controlId:"formRut",children:[e.jsx(r.Label,{children:"RUT"}),e.jsx(r.Control,{type:"text",name:"rut",value:t.rut,onChange:l,required:!0,isInvalid:!!j}),e.jsx(r.Control.Feedback,{type:"invalid",children:j||"Por favor, ingresa un RUT válido (ej. 12.345.678-9)."})]})})]}),e.jsxs(u,{children:[e.jsx(i,{md:6,children:e.jsxs(r.Group,{className:"mb-3",controlId:"formPhone",children:[e.jsx(r.Label,{children:"Número de Teléfono"}),e.jsx(r.Control,{type:"tel",name:"phone",value:t.phone,onChange:l,required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Por favor, ingresa tu número de teléfono."})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{className:"mb-3",controlId:"formEmail",children:[e.jsx(r.Label,{children:"Correo Electrónico"}),e.jsx(r.Control,{type:"email",name:"email",value:t.email,onChange:l,required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Por favor, ingresa un correo electrónico válido."})]})})]}),e.jsxs(r.Group,{className:"mb-3",controlId:"formAddress",children:[e.jsx(r.Label,{children:"Dirección / Comuna"}),e.jsx(r.Control,{type:"text",name:"address",value:t.address,onChange:l,required:!0}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Por favor, ingresa tu dirección o comuna."})]}),e.jsxs(u,{children:[e.jsx(i,{md:6,children:e.jsxs(r.Group,{className:"mb-3",controlId:"formFenceHeight",children:[e.jsx(r.Label,{children:"Altura del Cerco"}),e.jsxs(r.Select,{name:"fenceHeight",value:t.fenceHeight,onChange:l,required:!0,children:[e.jsx("option",{value:"",children:"Selecciona una altura"}),e.jsx("option",{children:"1.50m"}),e.jsx("option",{children:"1.90m"}),e.jsx("option",{children:"2.20m"}),e.jsx("option",{children:"Otra"})]}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Por favor, selecciona la altura del cerco."})]})}),e.jsx(i,{md:6,children:e.jsxs(r.Group,{className:"mb-3",controlId:"formLinearMeters",children:[e.jsx(r.Label,{children:"Metros Lineales (aprox.)"}),e.jsx(r.Control,{type:"number",name:"linearMeters",value:t.linearMeters,onChange:l,required:!0,min:"1"}),e.jsx(r.Control.Feedback,{type:"invalid",children:"Por favor, ingresa los metros lineales."})]})})]}),e.jsxs(r.Group,{className:"mb-3",controlId:"formMessage",children:[e.jsx(r.Label,{children:"Mensaje Adicional"}),e.jsx(r.Control,{as:"textarea",name:"message",rows:4,value:t.message,onChange:l,placeholder:"Indícanos cualquier detalle importante para tu proyecto."})]}),t.fenceHeight&&I.length>0&&e.jsx(h,{className:"mb-3 components-card",children:e.jsxs(h.Body,{children:[e.jsxs(h.Title,{children:["Componentes para ",t.fenceHeight]}),e.jsx("ul",{children:I.map((s,a)=>e.jsx("li",{children:s},a))})]})}),e.jsx("div",{className:"d-grid",children:e.jsx(R,{variant:"primary",type:"submit",size:"lg",children:"Enviar Cotización"})})]})]})})})}),e.jsx(u,{className:"justify-content-center mt-5",children:e.jsx(i,{md:8,children:e.jsx("img",{src:F(t.fenceHeight),alt:"Cerco de referencia",className:"img-fluid rounded shadow-lg"})})})]})})};export{B as default};
